"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};define("wixUrlParser/utils/urlParserUtils",["lodash","coreUtils"],function(e,t){function r(r){if(r.isResolvedSiteData)return r;var a=r.getCurrentUrlPageId(),i=e.get(r.getMasterPageData(),["data","document_data"]),n=e(i).filter({type:"PermaLink"}).keyBy("id").value(),o=e.keyBy(r.getPagesDataItems(),"id");o.masterPage=r.getDataByQuery("masterPage");var l=t.siteDataUtils,s={primaryPageId:r.getPrimaryPageId(),urlFormat:r.getUrlFormat(),mainPageId:r.getMainPageId(),externalBaseUrl:r.getExternalBaseUrl(),unicodeExternalBaseUrl:r.getUnicodeExternalBaseUrl(),publicBaseUrl:r.getPublicBaseUrl(),currentUrl:r.currentUrl,currentUrlPageId:a,isFeedbackEndpoint:r.isFeedbackEndpoint(),isSiteHistoryEndpoint:r.isSiteHistoryEndpoint(),isViewerMode:r.isViewerMode(),isWixSite:r.isWixSite(),languageCode:r.getLanguageCode(),isTemplate:r.isTemplate(),isUsingSlashUrlFormat:r.isUsingUrlFormat(t.siteConstants.URL_FORMATS.SLASH),isPremiumDomain:r.isPremiumDomain(),allPageIds:r.getAllPageIds(),routersConfigMap:e.get(r,"routers.configMap"),cookie:l.getRequestModel(r,"cookie"),rendererModel:{runningExperiments:l.getRendererModel(r,"runningExperiments")},serviceTopology:{basePublicUrl:r.getServiceTopologyProperty("basePublicUrl"),baseDomain:r.getServiceTopologyProperty("baseDomain"),staticDocsUrl:r.getServiceTopologyProperty("staticDocsUrl")},pagesDataItemsMap:o,permalinksMap:n,mapFromPageUriSeoToPageId:l.getMapFromPageUriSeoToPageId(r),pageResponseForUrl:r.pageResponseForUrl,rootNavigationInfo:r.getRootNavigationInfo()};return s.isResolvedSiteData=!0,s}return{getResolvedSiteData:r}}),define("wixUrlParser/parsers/slashUrlParser",["lodash","coreUtils","wixUrlParser/utils/urlParserUtils"],function(e,t,r){function a(r){var a=t.urlUtils.parseUrl(r.externalBaseUrl).host;return e.endsWith(a,"."+t.siteConstants.FREE_DOMAIN.WIXSITE)||e.endsWith(a,"."+r.serviceTopology.baseDomain)}function i(e){return e.isPremiumDomain&&!a(e)}function n(r){var a=e.isObject(r.currentUrl)?r.currentUrl.full:t.urlUtils.parseUrl(r.currentUrl).full;return r.isTemplate&&e.startsWith(a,r.serviceTopology.basePublicUrl)}function o(e){return"object"===("undefined"==typeof window?"undefined":_typeof(window))&&window.karmaIntegration?O.BEAKER:e.isFeedbackEndpoint?O.REVIEW:e.isSiteHistoryEndpoint?O.SITE_HISTORY:e.isViewerMode?i(e)?O.PREMIUM:e.isWixSite||n(e)?O.WIX_INTERNAL:O.FREE_SITE:O.PREVIEW}function l(t){return e.map(t,encodeURIComponent)}function s(t){return e.map(t,decodeURIComponent)}function u(t,r){var a=e.find(t.pagesDataItemsMap,{pageUriSEO:r});return a&&a.id}function p(r,a){var i=t.siteDataUtils.getMapFromPageUriSeoToPageId(r),n=e.get(i,a)||u(r,a)||t.errorPages.IDS.NOT_FOUND;return t.routerUtils.isDynamicPage(r.routersConfigMap,n)&&(n=t.errorPages.IDS.NOT_FOUND),n}function g(r,a){var i=t.urlUtils.parseUrl(r.externalBaseUrl).path.replace(/\/$/,"").split("/").length;return a?e.drop(a.split("/"),i):[]}function d(e){return e===w}function c(e,t){return!!t&&!!e.permalinksMap[t]}function U(e,t){var r=e.pagesDataItemsMap[t];return r&&"Page"===r.type&&r.tpaApplicationId>0}function f(e,t){var r=e.pagesDataItemsMap[t];return r&&"AppPage"===r.type&&"AppBuilderPage"===r.appPageType}function I(e,t){var r=e.pagesDataItemsMap[t];return r&&"AppPage"===r.type&&"AppPage"===r.appPageType&&r.appPageId===_}function m(e,t){var r=e.pagesDataItemsMap[t];return r&&"AppPage"===r.type&&"AppPage"===r.appPageType&&r.appPageId===C}function P(e,t){return m(e,t)||I(e,t)}function D(e){return e&&e.replace(/^https?:\/\//,"")}function v(e,r){var a=D(t.urlUtils.getBaseUrlWithPath(r,o(e)));return t.urlUtils.isSame(a,D(e.externalBaseUrl))||t.urlUtils.isSame(a,D(e.unicodeExternalBaseUrl))||t.urlUtils.isHostnameYandexWebvisor(a)||/^s3\.amazonaws\.com\/wix\-/.test(a)}function y(t,r){if(r)return e.find(t.routersConfigMap,{prefix:r})}function S(e){var r=e.query.q,a=/\:([^\:]+)\+$/.exec(r);return a&&a[1]&&t.urlUtils.parseUrl(a[1])||e}function E(r,a){var i=e.isObject(a)?a:t.urlUtils.parseUrl(a);if(i.hostname===W&&(i=S(i)),!v(r,i))return null;var n=g(r,i.path),o=e.head(n),l=e.drop(n,1),u={format:t.siteConstants.URL_FORMATS.SLASH},c=y(r,o);if(c&&(u.routerDefinition=c,u.pageAdditionalData=o+"/"+l.join("/")),u.routerDefinition){u.innerRoute=l.join("/");var I=r.pageResponseForUrl;I&&I.pageId&&(u.pageId=I.pageId,u.title=I.title)}else o?d(o)?(u.pageItemId=e.head(l),u.pageId=r.currentUrlPageId||r.mainPageId):(u.pageId=p(r,o),f(r,u.pageId)?u.title=n[2]:u.title=o):(u.pageId=r.mainPageId,u.title=R(r,u.pageId));i.query[F]&&(u.pageItemId=i.query[F],u.imageZoom=!0);var m=e.omit(i.query,B);return i.query&&!e.isEmpty(m)&&(u.queryParams=m),n.length>1&&!u.routerDefinition&&(f(r,u.pageId)?u.pageAdditionalData=e.head(l):d(o)?u.pageAdditionalData=e.drop(l,1).join("/"):U(r,u.pageId)?u.pageAdditionalData=s(l).join("/"):u.pageAdditionalData=l.join("/")),u}function R(r,a){var i=r.pagesDataItemsMap[a];return e.get(i,"pageUriSEO")||t.siteConstants.DEFAULT_PAGE_URI_SEO}function h(t){return e.omit(t.currentUrl.query,B)}function A(t){var r=e.get(t,"rootNavigationInfo.pageAdditionalData");if(r){var a=r.split("/");return e.drop(a,1).join("/")}}function b(r,a,i,n,o,s){var u=h(r),p=e.assign({},u,a.queryParams||{}),g=o||r.externalBaseUrl;g=g.replace(/\/$/,"");var d=c(r,a.pageItemId);if(a.routerId||a.routerDefinition?("CURRENT_INNER_ROUTE"===a.innerRoute&&(a.innerRoute=A(r)||a.innerRoute),g+="/"+(a.routerId?e.get(r.routersConfigMap,a.routerId+".prefix"):a.routerDefinition.prefix),a.innerRoute&&"/"!==a.innerRoute&&(g+="/"+a.innerRoute)):a.pageId&&!d&&(a.pageId!==r.mainPageId||i||a.pageAdditionalData)&&(g+="/"+R(r,a.pageId)),f(r,a.pageId)&&a.pageAdditionalData)g+="/"+a.pageAdditionalData+(a.title?"/"+a.title:"");else if(U(r,a.pageId)&&a.pageAdditionalData)g+="/"+l(a.pageAdditionalData.split("/")).join("/");else if(P(r,a.pageId)&&a.pageAdditionalData){var I=s&&s.getCustomUrlMapping?s.getCustomUrlMapping():void 0,m=e.findKey(I,{id:a.pageAdditionalData});g+=m?"/"+m:"/"+a.pageAdditionalData}return a.pageItemId&&(d?a.pageAdditionalData&&(g+="/"+w+"/"+a.pageItemId+"/"+a.pageAdditionalData):a.imageZoom&&(p[F]=a.pageItemId)),n||e.isEmpty(p)||r.currentUrl.hostname===W||(g+="?"+t.urlUtils.toQueryString(p)),g}function T(e,t){return E(r.getResolvedSiteData(e),t)}function x(e,t,a,i,n,o,l){return b(r.getResolvedSiteData(e),t,a,i,n,l)}function M(e,a){var i=t.urlUtils.parseUrl(a);return v(r.getResolvedSiteData(e),i)}var F="lightbox",B=[F],_="7326bfbb-4b10-4a8e-84c1-73f776051e10",C="79f391eb-7dfc-4adf-be6e-64434c4838d9",w="_p",O={PREVIEW:7,SITE_HISTORY:8,WIX_INTERNAL:2,FREE_SITE:1,PREMIUM:0,REVIEW:3,BEAKER:3},W="webcache.googleusercontent.com";return{parseUrl:T,getUrl:x,isUrlToCurrentSite:M}}),define("wixUrlParser/parsers/hashBangUrlParser",["loggingUtils","coreUtils","lodash","wixUrlParser/utils/urlParserUtils"],function(e,t,r,a){function i(r){var a;return"string"==typeof r?a=t.urlUtils.parseUrl(r):r.full?a=r:e.log.error("url to parse has to be either a string or an object"),a}function n(e,t){return r.includes(e.allPageIds,t)}function o(e,t){var r={},a=e.match(/#!(.*?)\/zoom[\/\|](.+?)\/([^\/]+)$/i);if(!a){var i=e.match(/#!(.*?)[\/\|]([^\/]+)\/?(.*$)/i);if(i){var o=i[1],l=i[2],s=i[3];return o&&(r.title=o),n(t,l)?r.pageId=l:(r.pageId=t.primaryPageId||t.mainPageId,r.pageItemId=l),s&&(r.pageAdditionalData=s),r}return{pageId:t.mainPageId}}return a[1]&&(r.title=a[1]),r.pageId=a[2],r.pageItemId=a[3],r.imageZoom=!0,r}function l(e,a,i,n){var o=e.currentUrl,l=n||e.externalBaseUrl;l=l.replace("."+t.siteConstants.FREE_DOMAIN.WIXSITE+"/","."+t.siteConstants.FREE_DOMAIN.WIX+"/");var s=o.query;return i||r.isEmpty(s)||(l+="?"+t.urlUtils.toQueryString(s)),o.url=l,a.id&&(l+="#!"+a.title+"/"+a.id),a.additionalData&&(l+="/"+a.additionalData),l}function s(e,t){if(!t)return null;var a=i("#"===t?e.currentUrl:t),n="localhost"===a.hostname;return u(e,a)&&!n?e.currentUrl.full!==a.full||r.includes(a.full,"#")?null:{pageId:e.mainPageId}:(r.isString(t)&&0===t.indexOf("#!")&&((a=r.clone(e.currentUrl)).hash=t),o(a.hash,e))}function u(e,r){return!(t.urlUtils.isHostnameYandexWebvisor(r.hostname)||d(e,r))}function p(e,t){var r=e.pagesDataItemsMap[t];return r&&"AppPage"===r.type&&"AppPage"===r.appPageType&&r.appPageId===m}function g(e){return e&&e.replace(/^https?:\/\//,"")}function d(e,r){var a=r.hostname+r.path;return t.urlUtils.isSame(a,g(e.externalBaseUrl))||t.urlUtils.isSame(a,g(e.unicodeExternalBaseUrl))}function c(e,r,a,i,n,o){var s={title:r.title||t.siteConstants.DEFAULT_PAGE_URI_SEO};if(r.pageItemId&&!r.pageAdditionalData&&r.imageZoom?(s.id="zoom",s.additionalData=r.pageId+"/"+r.pageItemId):(r.pageId!==e.mainPageId||r.pageAdditionalData||a)&&(s.id=r.pageItemId||r.pageId,s.additionalData=r.pageAdditionalData),p(e,r.pageId)&&o){var u=r.pageAdditionalData||"",g=o[u]||o[decodeURIComponent(u)]||{};s.id=r.pageId,s.title=g.title,s.additionalData=g.id}return l(e,s,i,n)}function U(e,t){return s(a.getResolvedSiteData(e),t)}function f(e,t,r,i,n,o){return c(a.getResolvedSiteData(e),t,r,i,n,o)}function I(e,r){if("#"===r)return!0;var i=t.urlUtils.parseUrl(r);return d(a.getResolvedSiteData(e),i)}var m="7326bfbb-4b10-4a8e-84c1-73f776051e10";return{parseUrl:U,getUrl:f,isUrlToCurrentSite:I}}),define("wixUrlParser",["lodash","coreUtils","wixUrlParser/parsers/slashUrlParser","wixUrlParser/parsers/hashBangUrlParser","wixUrlParser/utils/urlParserUtils"],function(e,t,r,a,i){function n(r,a){var i=e.isObject(a)?a:t.urlUtils.parseUrl(a);return!t.stringUtils.startsWith(i.hash,"#!")&&r.isUsingSlashUrlFormat}function o(e,t){return d[t||e.urlFormat]||d[e.urlFormat]}function l(e,t){return t===e.replace(/\/$/,"")+"/app"}function s(e,t){var o=i.getResolvedSiteData(e);return!t||l(o.externalBaseUrl,t)?null:"#"===t?s(o,o.currentUrl.full):n(o,t)?r.parseUrl(o,t):a.parseUrl(o,t)}function u(e,t,r,a,n,l){var s=i.getResolvedSiteData(e);return o(s,t.format).getUrl(s,t,r,a,n,l,e)}function p(e,t){var o=i.getResolvedSiteData(e);return n(o,t)?r.isUrlToCurrentSite(o,t):a.isUrlToCurrentSite(o,t)}function g(e,t){if(p(e,t)){var r=e.currentUrl.protocol;return t.replace(/^https?:/,r)}return t}var d={slash:r,hashBang:a};return{getUrl:u,parseUrl:s,utils:i,normalizeProtocolForSameSite:g}});
//# sourceMappingURL=wixUrlParser.min.js.map