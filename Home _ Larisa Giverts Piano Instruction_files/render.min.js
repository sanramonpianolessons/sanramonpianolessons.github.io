"use strict";define("render",["lodash","zepto","coreUtils","utils","core","reactDOM","experiment","animations","tweenEngine","TweenMax","TimelineMax","ScrollToPlugin","DrawSVGPlugin"],function(e,r,n,i,t,a,s,o,d,w,c){function l(e,r){window.clientSideRender?r&&r():requirejs(["warmup"],function(r){e(r)})}function u(e){r("#SITE_CONTAINER").attr("data-santa-render-status",e)}function p(e,r){var n=r.query,i=(e[n.configName||"fullFunctionality"]||e.fullFunctionality).getConfig();if(!n.dsOrigin)throw new Error("You must define dsOrigin parameter in order to use the documentServices - please speak to html-server team for a key");return i.origin=n.dsOrigin,i}function S(r,n,t){var a=e(t).keys().pull("masterPage").value();return e.mapValues(t,function(e,t){return n&&window.pagesData&&window.pagesData[t]?e:i.dataFixer.fix(e,a.slice(),r.requestModel,r.currentUrl,r.urlFormatModel,"site"===r.viewMode,r.rendererModel)})}function v(e,r,n,t){i.ajaxLibrary.ajax({type:"POST",url:"https://jy75p2avi1.execute-api.us-west-2.amazonaws.com/prod/logDiffs",dataType:"json",headers:{"x-api-key":"NrelGcqXZH9pIBYc3zjA77SIpiBKUkp643H7P41F"},data:{vsi:t,santaVersion:n,url:window.location.href,ssrDiverge:{clientMarkup:e,serverMarkup:r}}})}function f(r,n,i,s,o){l(function(e){e.willRender(n)}),window.clientSideRender&&window.santaRenderingError&&window.parent&&window.parent.postMessage({santaRenderingError:window.santaRenderingError.errorInfo},"*");var d=window.document.getElementById("SITE_CONTAINER").children[0];s.onBeforeLayout=function(){var e=window.document.getElementById("SITE_CONTAINER").children[0],r=e.innerHTML;window.sssr.clientSantaVersion=e.getAttribute("data-santa-version"),l(function(i){window.sssr.success=d===e,u(window.sssr.success?"SUCCESS":"DIVERGE"),window.sssr.clientSideRender={sinceInitialTimestamp:Date.now()-window.wixBiSession.initialTimestamp,performanceNow:D()},window.parent&&(window.sssr.success?window.parent.postMessage("sssrSuccess","*"):(window.sssr.clientSantaVersion!==window.sssr.serverSantaVersion&&(r=window.sssr.clientSantaVersion,window.sssr.serverMarkup=window.sssr.serverSantaVersion),window.sssr.clientMarkup=r,window.sssr.serverMarkup=window.sssr.serverMarkup||d.innerHTML,window.parent.postMessage({sssrFail:{clientMarkup:window.sssr.clientMarkup,serverMarkup:window.sssr.serverMarkup}},"*"),v(window.sssr.clientMarkup,window.sssr.serverMarkup,window.sssr.clientSantaVersion,n.wixBiSession.viewerSessionId))),i.didRender(n)},function(){u("CLIENT")})},t.renderer.renderSite(n,i,s,function(n){window.rendered?window.rendered.forceUpdate():(window.rendered=a.render(n,window.document.getElementById("SITE_CONTAINER")),window.onpopstate=window.rendered.onPopState,window.onhashchange=window.rendered.onHashChange,window.parent!==window&&requirejs(["santaPreview"],function(e){window.rendered.registerAspectToEvent("siteReady",function(){o&&o(window.rendered),window.documentServices&&(window.parent.postMessage("documentServicesLoaded","*"),window.createSantaPreview=e)})}),r.qaAutomation&&(e.set(window,"testApi.domSelectors",r.qaAutomation.getDomSelectors(r.react,r.reactDOM)),window.testApi.domSelectors.setSearchRoot(window.rendered),e.set(window,"testApi.isReady",!0)))})}function g(r,a,s){var l={};n.urlUtils.isQueryParamOn(s.currentUrl,"isSantaEditor")&&(l=e.assign(l,{componentViewMode:"editor"})),s.rendererModel.previewMode&&(l=e.assign(l,{isSocialInteractionAllowed:!1,isPlayingAllowed:!1})),s.renderFlags=e.assign({},s.renderFlags,l);var u=new i.FullSiteData(s),p=d.create(w,c);u.animations=o.create(p);var S=t.SiteDataAPI.createSiteDataAPIAndDal(u,a),v=S.siteData,f=S.siteDataAPI;return{fullSiteData:u,displayedSiteData:v,siteDataWrapper:S,viewerPrivateServices:{pointers:S.pointers,displayedDAL:S.displayedDal,siteDataAPI:f},isServerSideRender:v.isClientAfterSSR(),siteModel:s,siteDataAPI:f}}function m(r,n,t,a,o){var d=g(r,n,t),w=r.documentServices;try{w&&e.isUndefined(window.karmaIntegration)&&s.isOpen("sv_fullstory",t)&&i.integrations.fullStory.start(t)}catch(e){}if(w)d.siteDataWrapper.dataLoadedRegistrar=d.siteDataAPI.registerDataLoadedCallback.bind(d.siteDataAPI),window.documentServices=new w.Site(p(w.configs,d.siteModel.currentUrl),d.siteDataWrapper,e.partial(S,d.siteModel,d.isServerSideRender),e.partial(f,r,d.displayedSiteData,d.viewerPrivateServices,a)),e.set(window,"testApi.documentServices",window.documentServices);else{var c=d.siteDataWrapper.fullPagesData.pagesData;d.fullSiteData.pagesData=c&&S(d.siteModel,d.isServerSideRender,c),c.masterPage&&d.siteDataAPI.createDisplayedPage("masterPage"),f(r,d.displayedSiteData,d.viewerPrivateServices,a,o)}}var D=Object.freeze("undefined"!=typeof window&&window.performance&&window.performance.now?window.performance.now.bind(window.performance):Date.now.bind(Date));return{clientSide:m}});
//# sourceMappingURL=render.min.js.map